{"version":3,"file":"static/js/683.26c6761e.chunk.js","mappings":"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","sources":["components/pagination/index.tsx","pages/permission/index.tsx"],"sourcesContent":["import { ConfigProvider, Pagination } from 'antd'\nimport React, { useEffect, useState } from 'react'\nimport zhCN from 'antd/es/locale/zh_CN';\nconst MyPagination = (props: any) => {\n  // 分页总数\n  const [total, setTotal] = useState(0)\n  // 当前第几页\n  const [currentPage, setCurrentPage] = useState(0)\n  // 每页显示条数\n  const [pageSize, setPageSize] = useState(0)\n  useEffect(() => {\n    setTotal(props.total)\n    setCurrentPage(props.currentPage)\n    setPageSize(props.pageSize)\n  }, [props])\n\n  const onChangePage = (page: number, pageSize: number) => {\n    // 将切换的页码参数传递过去\n    props.onChange(page, pageSize)\n  }\n  return (\n    <div>\n      {/* 中文语言包 */}\n      < ConfigProvider locale={zhCN} >\n        <Pagination\n          style={{ textAlign: 'center', paddingTop: '10px', borderTop: '2px solid #fafafa' }}\n          current={currentPage} // 当前页\n          pageSize={pageSize} // 每页条数\n          total={total} // 数据总数\n          pageSizeOptions={[5, 15, 50, 100]} // 每页显示多少条\n          onChange={onChangePage} // 监听pageSize回调\n          showSizeChanger // 展示 pageSize 切换器\n          showQuickJumper // 快速跳转至某页\n          showTotal={total => `共有 ${total} 条数据`} // 展示页码\n        />\n      </ConfigProvider >\n    </div>\n  )\n}\nexport default MyPagination\n","import { Button, Table, Tag, Modal, message, Form, Input, Switch } from 'antd'\nimport React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux';\nimport { Dispatch, bindActionCreators } from 'redux';\nimport * as BlogActions from '@/redux/actionCreator';\nimport type { ColumnsType } from 'antd/es/table';\nimport MyPagination from '@/components/pagination';\nimport { DeleteOutlined, EditOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\nimport dayjs from 'dayjs';\nconst { confirm } = Modal;\ninterface DataType {\n  rightsId: any;\n  key: React.Key;\n  _id: string;\n  index: number;\n  label: string;\n  pagepermission: number | boolean;\n  grade: number;\n  create_time: string;\n  update_time: string;\n  children?: DataType[] | string;\n}\ninterface RightsData {\n  pagepermission: boolean;\n  totalCount: number;\n  page: number;\n  pageSize: number;\n  data: DataType[];\n}\nconst PermissionList = (props: any) => {\n  const columns: ColumnsType<DataType> = [\n    {\n      title: '权限名称',\n      dataIndex: 'label',\n    },\n    {\n      title: '权限路径',\n      dataIndex: 'key',\n      render: (key: string) => {\n        return <Tag color='orange'>{key}</Tag>\n      }\n    },\n    {\n      title: '创建时间',\n      dataIndex: 'create_time',\n      render: time => {\n        return dayjs(time * 1000).format('YYYY-MM-DD HH:mm:ss');\n      },\n    },\n    {\n      title: '更新时间',\n      dataIndex: 'update_time',\n      render: time => {\n        return time === 0 ? time : dayjs(time * 1000).format('YYYY-MM-DD HH:mm:ss');\n      },\n    },\n    {\n      title: '操作',\n      key: 'action',\n      render: (item) => {\n        return (\n          <div>\n            <Button\n              type=\"primary\"\n              danger\n              shape=\"circle\"\n              icon={<DeleteOutlined />}\n              onClick={() => {\n                rightsDelete(item);\n              }}\n              style={{ marginRight: '5px' }}\n            />\n            <Button\n              type=\"primary\"\n              ghost\n              shape=\"circle\"\n              icon={<EditOutlined />}\n              disabled={item.pagepermission === 2}\n              onClick={() => {\n                rightsUpdate(item);\n              }}\n              style={{ marginRight: '5px' }}\n            />\n          </div>\n        );\n      },\n    },\n  ];\n  // 初始值\n  const [dataSource, setDataSource] = useState<DataType[]>([])\n  // 分页总数\n  const [total, setTotal] = useState(0);\n  // 当前第几页\n  const [currentPage, setCurrentPage] = useState(1);\n  // 每页显示条数\n  const [pageSize, setPageSize] = useState(15);\n  // 更新窗口\n  const [isModalUpdateOpen, setIsModalUpdateOpen] = useState(false);\n  // 更新表单\n  const [updateForm] = Form.useForm();\n  // 保存当前更新的数据\n  const [updateData, setUpdateData] = useState<any>({});\n  // 权限状态\n  const [permissionStatus, setPermissionStatus] = useState<Boolean>()\n  // 获取权限列表\n  useEffect(() => {\n    props.BlogActions.asyncRightsListAction(currentPage, pageSize, '').then((res: RightsData) => {\n      // 获取权限\n      let { data, totalCount, page, pageSize } = res.data as unknown as RightsData;\n      data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n      setDataSource(data);\n      setTotal(totalCount);\n      setCurrentPage(page);\n      setPageSize(pageSize);\n    });\n  }, [currentPage, pageSize, props.BlogActions]);\n  // 分页效果\n  // 跳转页数据显示\n  const onChangePage = (page: number, pageSize: number, params = '') => {\n    // 重新调用接口将参数传递过去\n    props.BlogActions.asyncRightsListAction(page, pageSize, params).then((res: RightsData) => {\n      // 获取列表数据\n      let { data } = res.data as unknown as RightsData;\n      setDataSource(data);\n      // 切换行\n      setCurrentPage(page);\n      // 根据页面数据显示页码\n      setPageSize(pageSize);\n    });\n  };\n\n  // 点击更新\n  const rightsUpdate = (item: RightsData) => {\n    setIsModalUpdateOpen(true);\n    updateForm.setFieldsValue(item);\n    setPermissionStatus(Boolean(item.pagepermission))\n    setUpdateData(item);\n  };\n  // 更新操作\n  const handleUpdateConfirm = () => {\n    let value = updateForm.getFieldsValue();\n    if (updateData.grade === 1) {\n      props.BlogActions.asyncRightsUpdateAction({\n        label: value.label,\n        pagepermission: Number(value.pagepermission),\n        //@ts-ignore\n        id: updateData._id,\n      }).then(() => {\n        message.success('更新成功');\n        props.BlogActions.asyncRightsListAction(currentPage, pageSize, '').then((res: RightsData) => {\n          // 获取权限\n          let { data, totalCount, page, pageSize } = res.data as unknown as RightsData;\n          data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n          setDataSource(data);\n          setTotal(totalCount);\n          setCurrentPage(page);\n          setPageSize(pageSize);\n        });\n        updateForm.resetFields();\n        setIsModalUpdateOpen(false);\n      });\n    } else {\n      props.BlogActions.asyncRightsChildrenUpdateAction({\n        label: value.label,\n        pagepermission: Number(value.pagepermission),\n        //@ts-ignore\n        id: updateData._id,\n      }).then(() => {\n        message.success('菜单子权限更新成功');\n        props.BlogActions.asyncRightsListAction(currentPage, pageSize, '').then((res: RightsData) => {\n          // 获取权限\n          let { data, totalCount, page, pageSize } = res.data as unknown as RightsData;\n          data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n          setDataSource(data);\n          setTotal(totalCount);\n          setCurrentPage(page);\n          setPageSize(pageSize);\n        });\n        updateForm.resetFields();\n        setIsModalUpdateOpen(false);\n      });\n    }\n\n  };\n  // 删除\n  const rightsDelete = (item: DataType) => {\n    confirm({\n      title: '你确定要删除吗?',\n      icon: <ExclamationCircleOutlined />,\n      onOk() {\n        // 根据层级判断进行删除\n        if (item.grade === 1) {\n          // 先将要删除的数据过滤掉再调用接口\n          setDataSource(dataSource.filter((it) => it._id !== item._id));\n          message.success('权限删除成功');\n          props.BlogActions.asyncRightsDeleteAction(item._id).then(() => {\n            props.BlogActions.asyncRightsListAction(currentPage, pageSize, '').then((res: RightsData) => {\n              // 获取权限\n              let { data, totalCount, page, pageSize } = res.data as unknown as RightsData;\n              data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n              setDataSource(data);\n              setTotal(totalCount);\n              setCurrentPage(page);\n              setPageSize(pageSize);\n            });\n          });\n        } else {\n          // 根据子id查找到父id\n          let list = dataSource.filter((data: any) => data._id === item.rightsId);\n          // 将children字段进行重新替换\n          //@ts-ignore\n          list[0].children = list[0].children.filter((data: any) => data._id !== item._id)\n          setDataSource([...dataSource])\n          message.success('子菜单删除成功')\n          props.BlogActions.asyncRightsChildrenDeleteAction(item._id).then(() => {\n            props.BlogActions.asyncRightsListAction(currentPage, pageSize, '').then((res: RightsData) => {\n              // 获取权限\n              let { data, totalCount, page, pageSize } = res.data as unknown as RightsData;\n              data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n              setDataSource(data);\n              setTotal(totalCount);\n              setCurrentPage(page);\n              setPageSize(pageSize);\n            });\n          });\n        }\n      },\n    });\n  }\n  // 关闭窗口\n  const handleUpdateCancel = () => {\n    updateForm.resetFields();\n    setIsModalUpdateOpen(false);\n  };\n  const handleChangeStatus = () => {\n    setPermissionStatus(!permissionStatus)\n  }\n  return (\n    <div>\n      <Modal\n        open={isModalUpdateOpen}\n        title={<div style={{ textAlign: 'left' }}>更新权限</div>}\n        okText=\"更新\"\n        cancelText=\"取消\"\n        onCancel={handleUpdateCancel}\n        onOk={() => {\n          handleUpdateConfirm();\n        }}\n      >\n        <Form form={updateForm} layout=\"vertical\" name=\"basic\" className=\"userAddFrom\">\n          <Form.Item name=\"label\" label=\"权限名称\" rules={[{ required: true, message: '权限名称不能为空' }]}>\n            <Input />\n          </Form.Item>\n          <Form.Item name=\"pagepermission\" label=\"权限状态\" rules={[{ required: true, message: '权限状态不能为空' }]}>\n            {/* @ts-ignore */}\n            <Switch checkedChildren=\"开启\" unCheckedChildren=\"关闭\" checked={permissionStatus} onChange={handleChangeStatus} />\n          </Form.Item>\n        </Form>\n      </Modal>\n      <Table\n        columns={columns}\n        expandRowByClick={true}\n        scroll={{ y: 'calc(100vh - 210px)', x: true }}\n        dataSource={dataSource}\n        rowKey={(item) => {\n          return item._id;\n        }}\n        pagination={false}\n      />\n      <MyPagination\n        pageSize={pageSize}\n        currentPage={currentPage}\n        total={total}\n        onChange={onChangePage}\n      ></MyPagination>\n    </div>\n  )\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n  return {\n    BlogActions: bindActionCreators(BlogActions, dispatch),\n  };\n};\nexport default connect(null, mapDispatchToProps)(PermissionList);\n"],"names":["props","total","setTotal","useState","currentPage","setCurrentPage","pageSize","setPageSize","useEffect","locale","zhCN","style","textAlign","paddingTop","borderTop","current","pageSizeOptions","onChange","page","showSizeChanger","showQuickJumper","showTotal","confirm","Modal","connect","dispatch","BlogActions","bindActionCreators","columns","title","dataIndex","render","key","color","time","dayjs","format","item","type","danger","shape","icon","onClick","rightsDelete","marginRight","ghost","disabled","pagepermission","rightsUpdate","dataSource","setDataSource","isModalUpdateOpen","setIsModalUpdateOpen","updateForm","Form","updateData","setUpdateData","permissionStatus","setPermissionStatus","asyncRightsListAction","then","res","data","totalCount","map","index","children","length","setFieldsValue","Boolean","onOk","grade","filter","it","_id","message","asyncRightsDeleteAction","list","rightsId","asyncRightsChildrenDeleteAction","open","okText","cancelText","onCancel","resetFields","value","getFieldsValue","asyncRightsUpdateAction","label","Number","id","asyncRightsChildrenUpdateAction","handleUpdateConfirm","form","layout","name","className","rules","required","checkedChildren","unCheckedChildren","checked","expandRowByClick","scroll","y","x","rowKey","pagination","params"],"sourceRoot":""}