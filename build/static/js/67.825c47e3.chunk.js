"use strict";(self.webpackChunkiblog_admin=self.webpackChunkiblog_admin||[]).push([[67],{4327:function(e,n,t){t.d(n,{Z:function(){return p}});var i=t(5529),r=t(7309),a=t(50),s=t(3834),c=t(9372),o=t(446),l=t(5323),u=(t(2791),t(8687)),d=t(4880),m=t(7892),f=t.n(m),h=t(456),Z=t(6586),g=t(184),p=(0,u.$j)((function(e){return{isCollapsed:e.SideMenuStateReducer.isCollapsed}}),null)((0,d.EN)((function(e){var n=(0,h.Z)(localStorage.getItem("token"))[0].role[0].role_type,t=e.time,u=e.showBack,d=e.onRefresh,m=e.onSave,p=e.onBack,x=e.onDraft,v=e.onPublish,j=t?"\u4e0a\u6b21\u4fdd\u5b58\u65f6\u95f4\uff1a".concat(f()(1e3*t).format("YYYY-MM-DD HH:mm:ss")):"\u6682\u65e0\u64cd\u4f5c",b=e.isCollapsed?"calc(100% - 128px)":"calc(100% - 268px)";return(0,g.jsx)("div",{children:(0,g.jsx)(i.Z,{className:"save_card",bordered:!1,style:{width:b},children:(0,g.jsxs)("div",{className:"save",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)(a.Z,{}),(0,g.jsx)("span",{children:j})]}),(0,g.jsxs)("div",{className:"save_right",children:[u&&(0,g.jsx)(r.Z,{onClick:p||function(){e.history.goBack()},type:"primary",ghost:!0,icon:(0,g.jsx)(s.Z,{}),className:"save_right_btn",children:"\u8fd4\u56de"}),p&&(0,g.jsx)(r.Z,{onClick:p,type:"primary",ghost:!0,icon:(0,g.jsx)(c.Z,{}),className:"save_right_btn",children:"\u8fd4\u56de"}),d&&(0,g.jsx)(r.Z,{onClick:d,type:"primary",ghost:!0,icon:(0,g.jsx)(o.Z,{}),className:"save_right_btn",children:"\u5237\u65b0"}),m&&(0,g.jsx)(r.Z,{onClick:n?Z.iy:m,icon:(0,g.jsx)(l.Z,{}),className:"save_right_btn",children:"\u66f4\u65b0\u53d1\u5e03"}),x&&(0,g.jsx)(r.Z,{onClick:n?Z.ts:x,icon:(0,g.jsx)(l.Z,{}),className:"save_right_btn",children:"\u4fdd\u5b58\u8349\u7a3f"}),v&&(0,g.jsx)(r.Z,{onClick:n?Z.HL:v,icon:(0,g.jsx)(l.Z,{}),className:"save_right_btn",children:"\u53d1\u5e03\u6587\u7ae0"})]})]})})})})))},3802:function(e,n,t){t.d(n,{Z:function(){return v}});var i=t(9439),r=t(2791),a=t(9286),s=t(6988),c=t(5518),o=t(9428),l=t(8687),u=t(7781),d=t(8863),m=t(7863),f=t(7309),h=t(9389),Z=t(456),g=t(6586),p=t(184),x=function(e){var n=(0,Z.Z)(localStorage.getItem("token"))[0].role[0].role_type,t=m.Z.useForm(),a=(0,i.Z)(t,1)[0],s=(0,r.useState)(!1),c=(0,i.Z)(s,2),l=c[0],u=c[1];(0,r.useEffect)((function(){e.fileList.length>0&&a.setFieldsValue({url:e.fileList[0].thumbUrl?e.fileList[0].thumbUrl:""})}),[a,e.fileList,e.imgUrl]);return(0,p.jsxs)("div",{children:[(0,p.jsx)(f.Z,{className:"btn-input",onClick:function(){u(!0),""===e.imgUrl.url&&a.resetFields(),e.fileList.length>0&&a.setFieldsValue({url:e.fileList[0].thumbUrl?e.fileList[0].thumbUrl:""})},type:"primary",children:"\u8f93\u5165\u94fe\u63a5"}),(0,p.jsx)("div",{children:(0,p.jsx)(o.Z,{forceRender:!0,title:(0,p.jsx)("div",{style:{textAlign:"left"},children:"\u56fe\u7247\u94fe\u63a5 "}),open:l,okText:"\u6dfb\u52a0",cancelText:"\u53d6\u6d88",onOk:function(){if(n)return(0,g.BF)();var t=a.getFieldsValue();e.onChangeVal(t.url),u(!1)},onCancel:function(){u(!1)},children:(0,p.jsx)(m.Z,{form:a,children:(0,p.jsx)(m.Z.Item,{label:"\u56fe\u7247\u94fe\u63a5",name:"url",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u56fe\u7247\u94fe\u63a5"}],children:(0,p.jsx)(h.Z,{placeholder:"\u8bf7\u8f93\u5165\u56fe\u7247\u94fe\u63a5"})})})})})]})},v=(0,l.$j)(null,(function(e){return{BlogActions:(0,u.DE)(d,e)}}))((function(e){var n=(0,Z.Z)(localStorage.getItem("token"))[0].role[0].role_type,t=(0,r.useState)(!1),l=(0,i.Z)(t,2),u=l[0],d=l[1],m=(0,r.useState)(""),f=(0,i.Z)(m,2),h=f[0],v=f[1],j=(0,r.useState)(""),b=(0,i.Z)(j,2),y=b[0],w=b[1],k=(0,r.useState)([]),C=(0,i.Z)(k,2),A=C[0],P=C[1],S=(0,r.useState)({}),U=(0,i.Z)(S,2),B=U[0],_=U[1];(0,r.useEffect)((function(){P(void 0!==e.imgUrlArr?e.imgUrlArr:[])}),[e.imgUrlArr]);var F=(0,p.jsxs)("div",{children:[(0,p.jsx)(a.Z,{}),(0,p.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.Z,{listType:"picture-card",fileList:A,customRequest:n?g.b7:function(n){e.BlogActions.asyncFileUploadAction(n).then((function(n){s.ZP.success("\u4e0a\u4f20\u6210\u529f"),n&&(e.handleChange(n),P([{name:n.name,thumbUrl:n.url}]))}))},onPreview:function(e){v(e.thumbUrl),w(e.name),d(!0)},beforeUpload:function(e){var n="image/jpeg"===e.type||"image/png"===e.type||"image/webp"===e.type||"image/jpg"===e.type||"image/gif"===e.type;n||s.ZP.error("\u53ea\u5141\u8bb8\u4e0a\u4f20 JPG/PNG/WEBP/JPG/GIT \u6587\u4ef6!");var t=e.size/1024/1024<2;return t||s.ZP.error("\u56fe\u7247\u5927\u5c0f\u5fc5\u987b\u5c0f\u4e8e 2MB!"),n&&t},onRemove:function(n){e.handleRemove(n),P([]),_({url:""})},children:A.length>=1?null:F}),(0,p.jsx)(o.Z,{open:u,title:y,footer:null,onCancel:function(){return d(!1)},children:(0,p.jsx)("img",{alt:"example",style:{width:"100%"},src:h})}),(0,p.jsx)(x,{onChangeVal:function(n){e.handleChange(n);var t=n.indexOf("images"),i=n.indexOf("?",t),r=n.substring(t,i);P([{name:r,thumbUrl:n}])},fileList:A||[{name:"",thumbUrl:""}],imgUrl:B})]})}))},3067:function(e,n,t){t.r(n);var i=t(4165),r=t(1413),a=t(5861),s=t(9439),c=t(2791),o=t(9389),l=t(458),u=t(7863),d=t(6988),m=t(6090),f=t(6106),h=t(914),Z=t(1306),g=t(4327),p=t(8687),x=t(7781),v=t(8863),j=t(3802),b=t(1092),y=t.n(b),w=t(184),k=o.Z.TextArea,C=l.Z.Option,A={labelCol:{span:6},wrapperCol:{span:18}},P={labelCol:{span:0},wrapperCol:{span:24}};n.default=(0,p.$j)(null,(function(e){return{BlogActions:(0,x.DE)(v,e)}}))((function(e){var n=u.Z.useForm(),t=(0,s.Z)(n,1)[0],p=(0,c.useState)([]),x=(0,s.Z)(p,2),v=x[0],b=x[1],S=(0,c.useState)([]),U=(0,s.Z)(S,2),B=U[0],_=U[1],F=(0,c.useState)(0),L=(0,s.Z)(F,1)[0],T=(0,c.useState)(0),I=(0,s.Z)(T,1)[0],N=(0,c.useState)(),V=(0,s.Z)(N,2),E=V[0],D=V[1],R=(0,c.useState)(),q=(0,s.Z)(R,2),O=q[0],G=q[1],H=(0,c.useState)(),M=(0,s.Z)(H,2),Y=M[0],$=M[1],J=(0,c.useState)(),z=(0,s.Z)(J,2),Q=z[0],W=z[1],X=(0,c.useState)(),K=(0,s.Z)(X,2),ee=K[0],ne=K[1],te=(0,c.useState)([]),ie=(0,s.Z)(te,2),re=ie[0],ae=ie[1],se=(0,c.useState)(),ce=(0,s.Z)(se,2),oe=ce[0],le=ce[1],ue=(0,c.useState)(),de=(0,s.Z)(ue,2),me=de[0],fe=de[1],he=(0,c.useState)(),Ze=(0,s.Z)(he,2),ge=Ze[0],pe=Ze[1],xe=(0,c.useRef)();(0,c.useEffect)((function(){var n=e.match.params.id;G(n),e.BlogActions.asyncArticleDetailAction(e.match.params.id).then((function(e){var n=void 0===e.data.cover?"":e.data.cover,i=n.indexOf("images"),r=n.substring(i);e.data.cover=[{name:r,thumbUrl:e.data.cover}],ae(e.data.cover),fe(e.data.views),pe(e.data.comment),D(e.data.updateTime),ne(e.data.isTop),$(e.data.isComment),W(e.data.isLike),t.setFieldsValue(e.data)}))}),[t,e.BlogActions,e.match.params.id]),(0,c.useEffect)((function(){e.BlogActions.asyncCategoriesAction(L,I,"").then((function(e){var n=e.data.data;_(n)}))}),[L,I,e.BlogActions]),(0,c.useEffect)((function(){e.BlogActions.asyncTagsAction(L,I,"").then((function(e){var n=e.data.data;b(n)}))}),[L,I,e.BlogActions]);var ve=function(){var n=(0,a.Z)((0,i.Z)().mark((function n(){var a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.validateFields();case 2:return n.next=4,t.getFieldsValue();case 4:(a=n.sent).cover="object"===typeof oe?oe.url:oe,void 0===oe&&(a.cover=re[0].thumbUrl),e.BlogActions.asyncArticleUpdateAction((0,r.Z)((0,r.Z)({},a),{},{id:O,publishStatus:2,status:1,views:me,comment:ge,like:0,isComment:Y,isLike:Q,isTop:ee})).then((function(){m.Z.info({message:"\u4fee\u6539\u6210\u529f-\u4fdd\u5b58\u5230\u8349\u7a3f",description:"\u8df3\u8f6c\u5230\u6587\u7ae0\u5217\u8868"}),setTimeout((function(){e.history.push("/admin/article/list")}),500)}));case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}(),je=function(){var n=(0,a.Z)((0,i.Z)().mark((function n(){var a;return(0,i.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.validateFields();case 2:return n.next=4,t.getFieldsValue();case 4:(a=n.sent).cover="object"===typeof oe?oe.url:oe,void 0===oe&&(a.cover=re[0].thumbUrl),e.BlogActions.asyncArticleUpdateAction((0,r.Z)((0,r.Z)({id:O},a),{},{publishStatus:1,status:1,views:me,comment:ge,like:0,isComment:Y,isLike:Q,isTop:ee})).then((function(){m.Z.info({message:"\u4fee\u6539\u6210\u529f-\u53d1\u5e03\u5230\u7ebf\u4e0a",description:"\u5373\u5c06\u8df3\u8f6c\u5230\u6587\u7ae0\u5217\u8868"}),setTimeout((function(){e.history.push("/admin/article/list")}),500)}));case 8:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(g.Z,{time:E,onRefresh:function(){d.ZP.success("\u5237\u65b0\u6210\u529f"),e.BlogActions.asyncArticleDetailAction(e.match.params.id).then((function(e){e.data.cover=[{imgUrl:e.data.cover}],D(e.data.updateTime),t.setFieldsValue(e.data)}))},onDraft:ve,onPublish:je,onBack:function(){e.history.goBack()}}),(0,w.jsxs)("div",{className:"about",style:{height:"calc(100vh - 174px)",overflow:"auto"},children:["\u4fee\u6539\u6587\u7ae0",(0,w.jsxs)(u.Z,{form:t,children:[(0,w.jsxs)(f.Z,{children:[(0,w.jsxs)(h.Z,{span:12,children:[(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"title"},A),{},{label:"\u6587\u7ae0\u6807\u9898",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u9898"}],children:(0,w.jsx)(o.Z,{placeholder:"\u8bf7\u8f93\u5165\u6587\u7ae0\u6807\u9898"})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({label:"\u5206\u7c7b",name:"categories"},A),{},{rules:[{required:!0,message:"\u5206\u7c7b\u4e0d\u80fd\u4e3a\u7a7a"}],children:(0,w.jsx)(l.Z,{showSearch:!0,style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u5206\u7c7b\u4fe1\u606f",optionFilterProp:"children",children:B.map((function(e){return(0,w.jsx)(C,{value:e.name,children:e.name},e._id)}))})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({label:"\u6807\u7b7e",name:"tags"},A),{},{rules:[{required:!0,message:"\u6807\u7b7e\u4e0d\u80fd\u4e3a\u7a7a"}],children:(0,w.jsx)(l.Z,{mode:"multiple",style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9\u5bf9\u5e94\u7684\u6807\u7b7e",optionLabelProp:"label",children:v.map((function(e){return(0,w.jsx)(C,{value:e.name,label:e.name,children:e.name},e._id)}))})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"introduction"},A),{},{label:"\u6587\u7ae0\u7b80\u4ecb",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6587\u7ae0\u7b80\u4ecb"}],children:(0,w.jsx)(k,{showCount:!0,rows:4,maxLength:500})}))]}),(0,w.jsxs)(h.Z,{span:10,children:[(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"cover"},A),{},{label:"\u6587\u7ae0\u5c01\u9762",children:(0,w.jsx)(j.Z,{imgUrlArr:re,handleChange:function(e){le(e)},handleRemove:function(e){le("")}})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"isComment"},A),{},{label:"\u8bc4\u8bba",children:(0,w.jsx)(Z.Z,{checked:Y,onChange:function(e){$(e)}})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"isLike"},A),{},{label:"\u70b9\u8d5e",children:(0,w.jsx)(Z.Z,{checked:Q,onChange:function(e){W(e)}})})),(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"isTop"},A),{},{label:"\u7f6e\u9876",children:(0,w.jsx)(Z.Z,{checked:ee,onChange:function(e){ne(e)}})}))]})]}),(0,w.jsx)(f.Z,{children:(0,w.jsx)(h.Z,{span:24,children:(0,w.jsx)(u.Z.Item,(0,r.Z)((0,r.Z)({name:"content"},P),{},{children:(0,w.jsx)(y(),{preview:!1,subfield:!1,placeholder:"\u8bf7\u64b0\u5199\u6587\u7ae0",ref:xe,addImg:function(n){return function(n){var t=new FormData;t.append("file",n),e.BlogActions.asyncFileUploadAction(t).then((function(e){e&&xe.current.$img2Url(n.name,e.url)}))}(n)}})}))})})]})]})]})}))},6586:function(e,n,t){t.d(n,{BF:function(){return p},HL:function(){return h},Lk:function(){return o},Qk:function(){return l},TV:function(){return u},XE:function(){return a},b7:function(){return g},eV:function(){return m},iy:function(){return f},pv:function(){return s},ts:function(){return Z},uB:function(){return r},xc:function(){return d},yP:function(){return c}});var i=t(6988),r=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u5220\u9664\u64cd\u4f5c\ud83d\ude05")},a=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u66f4\u65b0\u64cd\u4f5c\ud83d\ude05")},s=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u6dfb\u52a0\u64cd\u4f5c\ud83d\ude05")},c=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u5ba1\u6279\u64cd\u4f5c\ud83d\ude05")},o=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u4e00\u952e\u5ba1\u6279\u64cd\u4f5c\ud83d\ude05")},l=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u4e0b\u7ebf\u6587\u7ae0\u64cd\u4f5c\ud83d\ude05")},u=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u4e0a\u7ebf\u6587\u7ae0\u64cd\u4f5c\ud83d\ude05")},d=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u7f6e\u9876\u64cd\u4f5c\ud83d\ude05")},m=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u72b6\u6001\u53d8\u66f4\u64cd\u4f5c\ud83d\ude05")},f=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u53d1\u5e03\u64cd\u4f5c\ud83d\ude05")},h=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u53d1\u5e03\u6587\u7ae0\u64cd\u4f5c\ud83d\ude05")},Z=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u4fdd\u5b58\u8349\u7a3f\u64cd\u4f5c\ud83d\ude05")},g=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u4e0a\u4f20\u56fe\u7247\u64cd\u4f5c\ud83d\ude05")},p=function(){return i.ZP.warning("\u8bbf\u5ba2\u6682\u4e0d\u652f\u6301\u8f93\u5165\u56fe\u7247\u94fe\u63a5\u64cd\u4f5c\ud83d\ude05")}}}]);
//# sourceMappingURL=67.825c47e3.chunk.js.map