{"version":3,"file":"static/js/94.d5570424.chunk.js","mappings":"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","sources":["components/pagination/index.tsx","pages/permission/RoleList.tsx","../node_modules/@ant-design/icons-svg/es/asn/EditOutlined.js","../node_modules/@ant-design/icons/es/icons/EditOutlined.js"],"sourcesContent":["import { ConfigProvider, Pagination } from 'antd'\nimport React, { useEffect, useState } from 'react'\nimport zhCN from 'antd/es/locale/zh_CN';\nconst MyPagination = (props: any) => {\n  // 分页总数\n  const [total, setTotal] = useState(0)\n  // 当前第几页\n  const [currentPage, setCurrentPage] = useState(0)\n  // 每页显示条数\n  const [pageSize, setPageSize] = useState(0)\n  useEffect(() => {\n    setTotal(props.total)\n    setCurrentPage(props.currentPage)\n    setPageSize(props.pageSize)\n  }, [props])\n\n  const onChangePage = (page: number, pageSize: number) => {\n    // 将切换的页码参数传递过去\n    props.onChange(page, pageSize)\n  }\n  return (\n    <div>\n      {/* 中文语言包 */}\n      < ConfigProvider locale={zhCN} >\n        <Pagination\n          style={{ marginTop: \"10px\" }}\n          current={currentPage} // 当前页\n          pageSize={pageSize} // 每页条数\n          total={total} // 数据总数\n          pageSizeOptions={[5, 10, 50, 100]} // 每页显示多少条\n          onChange={onChangePage} // 监听pageSize回调\n          showSizeChanger // 展示 pageSize 切换器\n          showQuickJumper // 快速跳转至某页\n          showTotal={total => `共有 ${total} 条数据`} // 展示页码\n        />\n      </ConfigProvider >\n    </div>\n  )\n}\nexport default MyPagination\n","import { Button, Table, Modal, message, Form, Input, Tree } from 'antd'\nimport React, { useEffect, useState } from 'react'\nimport { connect } from 'react-redux';\nimport { Dispatch, bindActionCreators } from 'redux';\nimport * as BlogActions from '@/redux/actionCreator';\nimport type { ColumnsType } from 'antd/es/table';\nimport MyPagination from '@/components/pagination';\nimport { DeleteOutlined, EditOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\nimport dayjs from 'dayjs';\nconst { confirm } = Modal;\ninterface DataType {\n  _id: string;\n  role_type: number;\n  role_name: string;\n  rights: string[];\n  create_time: string;\n  update_time: string;\n  rightsId: any;\n  key: React.Key;\n  index: number;\n  label: string;\n  title?: string;\n  pagepermission: number | boolean;\n  grade: number;\n  children?: DataType[] | string;\n}\ninterface RoleData {\n  totalCount: number;\n  page: number;\n  pageSize: number;\n  data: DataType[];\n}\n\ninterface RightsData {\n  pagepermission: boolean;\n  totalCount: number;\n  page: number;\n  pageSize: number;\n  data: DataType[];\n}\nconst RoleList = (props: any) => {\n  const columns: ColumnsType<DataType> = [\n    {\n      title: '角色名称',\n      dataIndex: 'role_name',\n    },\n    {\n      title: '创建时间',\n      dataIndex: 'create_time',\n      render: time => {\n        return dayjs(time * 1000).format('YYYY-MM-DD HH:mm:ss');\n      },\n    },\n    {\n      title: '更新时间',\n      dataIndex: 'update_time',\n      render: time => {\n        return time === 0 ? time : dayjs(time * 1000).format('YYYY-MM-DD HH:mm:ss');\n      },\n    },\n    {\n      title: '操作',\n      key: 'action',\n      render: (item) => {\n        return (\n          <div>\n            <Button\n              type=\"primary\"\n              danger\n              shape=\"circle\"\n              icon={<DeleteOutlined />}\n              onClick={() => {\n                roleDelete(item);\n              }}\n              style={{ marginRight: '5px' }}\n            />\n            <Button\n              type=\"primary\"\n              ghost\n              shape=\"circle\"\n              icon={<EditOutlined />}\n              disabled={item.pagepermission === 2}\n              onClick={() => {\n                roleUpdate(item);\n                setCurrentRights(item.rights)\n              }}\n              style={{ marginRight: '5px' }}\n            />\n          </div>\n        );\n      },\n    },\n  ];\n  // 初始值\n  const [dataSource, setDataSource] = useState<DataType[]>([])\n  // 权限数据\n  const [rightsData, setRightsData] = useState<any>([])\n  // 分页总数\n  const [total, setTotal] = useState(0);\n  // 当前第几页\n  const [currentPage, setCurrentPage] = useState(1);\n  // 每页显示条数\n  const [pageSize, setPageSize] = useState(10);\n  // 更新窗口\n  const [isModalUpdateOpen, setIsModalUpdateOpen] = useState(false);\n  // 更新表单\n  const [updateForm] = Form.useForm();\n  // 保存当前更新的数据\n  const [updateData, setUpdateData] = useState<any>({});\n  // 当前项的数组数据\n  const [currentRights, setCurrentRights] = useState([])\n  // 获取角色列表\n  useEffect(() => {\n    props.BlogActions.asyncRoleListAction(currentPage, pageSize, '').then((res: RoleData) => {\n      // 获取角色\n      let { data, totalCount, page, pageSize } = res.data as unknown as RoleData;\n      setDataSource(data);\n      setTotal(totalCount);\n      setCurrentPage(page);\n      setPageSize(pageSize);\n    });\n  }, [currentPage, pageSize, props.BlogActions]);\n  // 获取权限列表\n  useEffect(() => {\n    props.BlogActions.asyncRightsListAction('', '', '').then((res: RightsData) => {\n      // 获取权限\n      let { data } = res.data as unknown as RightsData;\n      data.map((item: any, index: number) => item.children.length < 1 ? data[index].children = \"\" : data)\n      let newData = data.map((item: any) => {\n        return {\n          'title': item.label,\n          'key': item.key,\n          'children': item.children ? item.children.map((child: any) => {\n            return {\n              'title': child.label,\n              'key': child.key,\n              'children': []\n            }\n          }) : []\n        }\n      })\n      setRightsData(newData);\n    });\n  }, [currentPage, pageSize, props.BlogActions]);\n  // 分页效果\n  // 跳转页数据显示\n  const onChangePage = (page: number, pageSize: number, params = '') => {\n    // 重新调用接口将参数传递过去\n    props.BlogActions.asyncRightsListAction(page, pageSize, params).then((res: RoleData) => {\n      // 获取列表数据\n      let { data } = res.data as unknown as RoleData;\n      setDataSource(data);\n      // 切换行\n      setCurrentPage(page);\n      // 根据页面数据显示页码\n      setPageSize(pageSize);\n    });\n  };\n  // 点击更新\n  const roleUpdate = (item: RoleData) => {\n    setIsModalUpdateOpen(true);\n    updateForm.setFieldsValue(item);\n    setUpdateData(item);\n  };\n  // 更新操作\n  const handleUpdateConfirm = () => {\n    let value = updateForm.getFieldsValue();\n    setDataSource(dataSource.map((item: any) => {\n      if (item._id === updateData._id) {\n        return {\n          ...item,\n          rights: currentRights\n        }\n      }\n      return item;\n    }))\n    props.BlogActions.asyncRoleUpdateAction({\n      role_name: value.role_name,\n      rights: currentRights,\n      //@ts-ignore\n      id: updateData._id,\n    }).then(() => {\n      message.success('更新成功');\n      props.BlogActions.asyncRoleListAction(currentPage, pageSize, '').then((res: RoleData) => {\n        // 获取角色\n        let { data, totalCount, page, pageSize } = res.data as unknown as RoleData;\n\n        setDataSource(data);\n        setTotal(totalCount);\n        setCurrentPage(page);\n        setPageSize(pageSize);\n      });\n      setIsModalUpdateOpen(false);\n    });\n\n\n  };\n  // 删除\n  const roleDelete = (item: DataType) => {\n    confirm({\n      title: '你确定要删除吗?',\n      icon: <ExclamationCircleOutlined />,\n      onOk() {\n        // 先将要删除的数据过滤掉再调用接口\n        setDataSource(dataSource.filter((it) => it._id !== item._id));\n        message.success('角色删除成功');\n        props.BlogActions.asyncRoleDeleteAction(item._id).then(() => {\n          props.BlogActions.asyncRoleListAction(currentPage, pageSize, '').then((res: RoleData) => {\n            // 获取角色\n            let { data, totalCount, page, pageSize } = res.data as unknown as RoleData;\n            setDataSource(data);\n            setTotal(totalCount);\n            setCurrentPage(page);\n            setPageSize(pageSize);\n          });\n        });\n      }\n    });\n  }\n  // 关闭窗口\n  const handleUpdateCancel = () => {\n    setIsModalUpdateOpen(false);\n  };\n  // 监听选中\n  const onCheck = (checkKeys: any) => {\n    setCurrentRights(checkKeys.checked)\n  }\n  return (\n    <div>\n      <Modal\n        open={isModalUpdateOpen}\n        title={<div style={{ textAlign: 'left' }}>权限分配</div>}\n        okText=\"更新\"\n        cancelText=\"取消\"\n        onCancel={handleUpdateCancel}\n        onOk={() => {\n          handleUpdateConfirm();\n        }}\n      >\n        <Form form={updateForm} layout=\"vertical\" name=\"basic\" className=\"userAddFrom\">\n          <Form.Item name=\"role_name\" label=\"角色名称\" rules={[{ required: true, message: '角色名称不能为空' }]}>\n            <Input />\n          </Form.Item>\n        </Form>\n        <Tree\n          checkable\n          checkedKeys={currentRights}\n          checkStrictly={true}\n          onCheck={onCheck}\n          treeData={rightsData}\n        />\n      </Modal>\n      <Table\n        columns={columns}\n        expandRowByClick={true}\n        dataSource={dataSource}\n        rowKey={(item) => {\n          return item._id;\n        }}\n        pagination={false}\n      />\n      <MyPagination\n        pageSize={pageSize}\n        currentPage={currentPage}\n        total={total}\n        onChange={onChangePage}\n      ></MyPagination>\n    </div>\n  )\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n  return {\n    BlogActions: bindActionCreators(BlogActions, dispatch),\n  };\n};\nexport default connect(null, mapDispatchToProps)(RoleList);\n","// This icon file is generated automatically.\nvar EditOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z\" } }] }, \"name\": \"edit\", \"theme\": \"outlined\" };\nexport default EditOutlined;\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport EditOutlinedSvg from \"@ant-design/icons-svg/es/asn/EditOutlined\";\nimport AntdIcon from '../components/AntdIcon';\nvar EditOutlined = function EditOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _objectSpread(_objectSpread({}, props), {}, {\n    ref: ref,\n    icon: EditOutlinedSvg\n  }));\n};\nEditOutlined.displayName = 'EditOutlined';\nexport default /*#__PURE__*/React.forwardRef(EditOutlined);"],"names":["props","useState","total","setTotal","currentPage","setCurrentPage","pageSize","setPageSize","useEffect","locale","zhCN","style","marginTop","current","pageSizeOptions","onChange","page","showSizeChanger","showQuickJumper","showTotal","confirm","Modal","connect","dispatch","BlogActions","bindActionCreators","columns","title","dataIndex","render","time","dayjs","format","key","item","type","danger","shape","icon","onClick","roleDelete","marginRight","ghost","disabled","pagepermission","roleUpdate","setCurrentRights","rights","dataSource","setDataSource","rightsData","setRightsData","isModalUpdateOpen","setIsModalUpdateOpen","Form","updateForm","updateData","setUpdateData","currentRights","asyncRoleListAction","then","res","data","totalCount","asyncRightsListAction","map","index","children","length","newData","label","child","setFieldsValue","onOk","filter","it","_id","message","asyncRoleDeleteAction","open","textAlign","okText","cancelText","onCancel","value","getFieldsValue","asyncRoleUpdateAction","role_name","id","handleUpdateConfirm","form","layout","name","className","rules","required","checkable","checkedKeys","checkStrictly","onCheck","checkKeys","checked","treeData","expandRowByClick","rowKey","pagination","params","EditOutlined","ref","React","AntdIcon","_objectSpread","EditOutlinedSvg","displayName"],"sourceRoot":""}